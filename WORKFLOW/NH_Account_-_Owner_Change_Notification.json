{
    "version": 1,
    "var_self": {
        "type": "WORKFLOW",
        "id": "f56b4367-e6f9-4fbe-9ba0-c13fa7be39f0",
        "name": "NH Account - Owner Change Notification"
    },
    "object": {
        "id": "f56b4367-e6f9-4fbe-9ba0-c13fa7be39f0",
        "name": "NH Account - Owner Change Notification",
        "description": "When an user, who has been assigned as the owner of any non-human account, either leaves the organization (termination of identity) or goes on LOA (suspension of identity) or approves an owner update SNAP request, user’s manager will be assigned as new owner through a new cloud rule – Non-Humans – Manager Correlation. \nThis workflow will be used for notifying the new owner (old owner’s manager).",
        "created": "2025-05-26T08:45:53.367377875Z",
        "modified": "2025-05-26T12:09:22.388131985Z",
        "modifiedBy": {
            "type": "IDENTITY",
            "id": "8b3c97da521442999ef05af532ecf6f7",
            "name": "rahul.majumder"
        },
        "definition": {
            "start": "Compare Strings 1",
            "steps": {
                "Compare Strings": {
                    "actionId": "sp:compare-strings",
                    "choiceList": [
                        {
                            "comparator": "StringMatches",
                            "nextStep": "Get Identity 1",
                            "variableA.$": "$.defineVariable.userTypes",
                            "variableB.$": "$.getIdentity.attributes.userType"
                        }
                    ],
                    "defaultStep": "End Step - Success",
                    "displayName": "",
                    "type": "choice"
                },
                "Compare Strings 1": {
                    "actionId": "sp:compare-strings",
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "End Step - Success",
                            "variableA.$": "$.trigger.changes[?(@.attribute=='managerFullName')].oldValue",
                            "variableB": "None"
                        }
                    ],
                    "defaultStep": "Get Identity",
                    "displayName": "",
                    "type": "choice"
                },
                "Define Variable": {
                    "actionId": "sp:define-variable",
                    "attributes": {
                        "id": "sp:define-variable",
                        "variables": [
                            {
                                "description": "",
                                "name": "userTypes",
                                "transforms": [],
                                "variableA": "TEST,SVC,BOT,PRF,PRA"
                            }
                        ]
                    },
                    "displayName": "",
                    "nextStep": "Compare Strings",
                    "type": "Mutation"
                },
                "End Step - Success": {
                    "actionId": "sp:operator-success",
                    "displayName": "",
                    "type": "success"
                },
                "Get Identity": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.trigger.identity.id"
                    },
                    "displayName": "",
                    "nextStep": "Define Variable",
                    "type": "action",
                    "versionNumber": 2
                },
                "Get Identity 1": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.getIdentity.managerRef.id"
                    },
                    "description": "Get Manager Identity Information for list of",
                    "displayName": "",
                    "nextStep": "Send Email",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "Dear ${managerFirstName},<br>\n<br>\nOwnership of the following Non-Human Account has been transferred to you:<br>\n<br>\n<b>Account Name (sAMAccountName)</b>: ${NHAccountName}<br>\n<b>UPN</b>: ${UPN}<br>\n<b>Environment</b>: ${environment}<br>\n<b>Display Name</b>: ${displayName}<br>\n<b>Account Type</b>: ${acctType}<br>\n<b>Description</b>: ${description}<br>\n<b>Status</b>: ${lcs}<br>\n<br>\nThis transfer was triggered by the offboarding of the previously assigned owner, ${oldManagerName}, or by a SNAP Request approved by ${oldManagerName}.\n<br>\nIf you wish to transfer ownership of this account to a different person, follow the instructions in the link below to submit a SNAP request.<br>\n<br>\n<a href=\"https://igmfinancial.service-now.com/snap?id=kb_article_view&sysparm_article=KB0015994\">IGM - SNAP - How to request a new or update a Non-Human Account</a><br>\n<br>\nThis is a system-generated email. Please do not respond to this email.<br>\n<br>\nBonjour ${managerFirstName},<br>\n<br>\nLa propriété du compte non humain suivant vous a été transférée :<br>\n<br>\n<b>Nom du compte (sAMAccountName)</b>: ${NHAccountName}<br>\n<b>Nom principal de l’utilisateur (UPN)</b>: ${UPN}<br>\n<b>Environnement</b>: ${environment}<br>\n<b>Nom d’affichage</b>: ${displayName}<br>\n<b>Type de compte</b>: ${acctType}<br>\n<b>Description</b>: ${description}<br>\n<b>État</b>: ${lcs}<br>\n<br>\nCe transfert a été déclenché par le départ de l’ancien titulaire assigné, ${oldManagerName}, ou fait suite à une demande SNAP approuvée par ${oldManagerName}.\n<br>\nSi vous souhaitez transférer la propriété de ce compte à une autre personne, veuillez soumettre une demande SNAP en suivant les instructions accessibles par le lien ci-dessous.<br>\n<br>\n<a href=\"https://igmfinancial.service-now.com/snap?id=kb_article_view&sysparm_article=KB0015994\">IGM - SNAP - Comment demander la création ou la mise à jour d’un compte non humain</a><br>\n<br>\nCe courriel a été produit par le système. Veuillez ne pas y répondre.",
                        "context": {
                            "NHAccountName.$": "$.getIdentity.attributes.samaccountname",
                            "UPN.$": "$.getIdentity.attributes.upn",
                            "acctType.$": "$.getIdentity.attributes.userType",
                            "description.$": "$.getIdentity.attributes.fullDescription",
                            "displayName.$": "$.getIdentity.attributes.displayName",
                            "environment.$": "$.getIdentity.attributes.applicationEnvironment",
                            "lcs.$": "$.getIdentity.attributes.cloudLifecycleState",
                            "managerFirstName.$": "$.getIdentity1.attributes.firstname",
                            "oldManagerName.$": "$.trigger.changes[?(@.attribute=='managerFullName')].oldValue"
                        },
                        "from": null,
                        "recipientEmailList.$": "$.getIdentity1.attributes.email",
                        "subject": "Change of Owner for Non-Human Account: ${NHAccountName}/Changement de titulaire pour un compte non humain: ${NHAccountName}"
                    },
                    "description": "Send email to manager's manager.",
                    "displayName": "",
                    "nextStep": "End Step - Success",
                    "type": "action",
                    "versionNumber": 2
                }
            }
        },
        "enabled": false,
        "creator": {
            "type": "IDENTITY",
            "id": "cf41145275194a66bd2989bcac443640",
            "name": "jyoti.gupta"
        },
        "owner": {
            "type": "IDENTITY",
            "id": "cf41145275194a66bd2989bcac443640",
            "name": "jyoti.gupta"
        },
        "trigger": {
            "type": "EVENT",
            "attributes": {
                "filter.$": "$.changes[?(@.attribute == \"managerFullName\")]",
                "id": "idn:identity-attributes-changed"
            }
        }
    }
}