{
    "version": 1,
    "var_self": {
        "type": "WORKFLOW",
        "id": "f069ef1a-4839-4bbb-8e2e-0eeaaa0dd0ba",
        "name": "Notification Suspension or Leave of Absence -old"
    },
    "object": {
        "id": "f069ef1a-4839-4bbb-8e2e-0eeaaa0dd0ba",
        "name": "Notification Suspension or Leave of Absence -old",
        "description": "Lifecycle state changed to suspended",
        "created": "2023-02-02T18:05:53.582598785Z",
        "modified": "2024-11-05T18:38:31.753616624Z",
        "modifiedBy": {
            "type": "IDENTITY",
            "id": "2c9180848439717c01843e07a4e206a4",
            "name": "2007122"
        },
        "definition": {
            "start": "Compare Strings",
            "steps": {
                "Compare Strings": {
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "Get Identity",
                            "variableA.$": "$.trigger.changes[?(@.attribute=='cloudLifecycleState')].newValue",
                            "variableB": "suspended"
                        }
                    ],
                    "defaultStep": "success",
                    "description": "Suspended?",
                    "type": "choice"
                },
                "Compare Strings 1": {
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "Send Email 1",
                            "variableA.$": "$.getIdentity.attributes.userType",
                            "variableB": "Advisor"
                        }
                    ],
                    "defaultStep": "Get Identity 1",
                    "description": "Check if an advisor, they don't have a manager so we have to handle differently",
                    "type": "choice"
                },
                "Get Identity": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.trigger.identity.id"
                    },
                    "description": "Get Contractor Identity Information",
                    "nextStep": "Compare Strings 1",
                    "type": "action",
                    "versionNumber": 2
                },
                "Get Identity 1": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.getIdentity.managerRef.id"
                    },
                    "description": "Get Manager Identity Information for email",
                    "nextStep": "Send Email",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "<p>Dear ${managerFirstName} ${managerLastName},<br><br>The account has been suspended successfully and all system access has been disabled.<br><br>Name: ${firstName} ${lastName}<br>Username: ${sAMAccountName}<br><br>If this was processed in error, please contact the IGM Service Desk.<br><br>IGM Service Desk <br>Mon &ndash; Fri 7:30 am to 7:30 pm ET<br>Phone Number: 1-800-661-2040<br>SNAP Portal &ndash; Live Chat / Get Help<br>https://igmfinancial.service-now.com/snap<br>This is a system-generated email. Please do not respond to this email.<br><br><br><br>Bonjour ${managerFirstName} ${managerLastName},<br><br>Le compte a &eacute;t&eacute; suspendu avec succ&egrave;s et tous les acc&egrave;s au syst&egrave;me ont &eacute;t&eacute; d&eacute;sactiv&eacute;s. <br><br>Nom : ${firstName} ${lastName}<br>Nom d&rsquo;utilisateur : ${sAMAccountName}<br><br>Si la suspension a &eacute;t&eacute; op&eacute;r&eacute;e par erreur, veuillez communiquer avec le Bureau des services technologiques d&rsquo;IGM. <br><br>Bureau des services technologiques d&rsquo;IGM <br>Lundi au vendredi de 7 h 30 &agrave; 19 h 30 (HE) <br>Num&eacute;ro de t&eacute;l&eacute;phone : 1-800-661-2040 <br>Portail SNAP &ndash; Clavardage en direct/Aide <br>https://igmfinancial.service-now.com/snap&nbsp;<br>Ce courriel a &eacute;t&eacute; produit par le syst&egrave;me. Veuillez ne pas y r&eacute;pondre.</p>",
                        "context": {
                            "firstName.$": "$.getIdentity.attributes.firstname",
                            "lastName.$": "$.getIdentity.attributes.lastname",
                            "managerFirstName.$": "$.getIdentity1.attributes.firstname",
                            "managerLastName.$": "$.getIdentity1.attributes.lastname",
                            "sAMAccountName.$": "$.getIdentity.attributes.samaccountname"
                        },
                        "from": null,
                        "recipientEmailList.$": "$.getIdentity1.attributes.email",
                        "replyTo": "",
                        "subject": "Account Suspended for ${firstName} ${lastName} / Le compte de ${firstName} ${lastName} a été suspendu"
                    },
                    "description": "Send email to manager",
                    "nextStep": "success",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email 1": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "<p>Dear Field Network Administration<br><br>The account has been suspended successfully and all system access has been disabled.<br><br>Name: ${firstName} ${lastName}<br>Username: ${sAMAccountName}<br><br>If this was processed in error, please contact the IGM Service Desk.<br><br>IGM Service Desk <br>Mon &ndash; Fri 7:30 am to 7:30 pm ET<br>Phone Number: 1-800-661-2040<br>SNAP Portal &ndash; Live Chat / Get Help<br>https://igmfinancial.service-now.com/snap<br>This is a system-generated email. Please do not respond to this email.<br><br><br><br>Bonjour Field Network Administration,<br><br>Le compte a &eacute;t&eacute; suspendu avec succ&egrave;s et tous les acc&egrave;s au syst&egrave;me ont &eacute;t&eacute; d&eacute;sactiv&eacute;s. <br><br>Nom : ${firstName} ${lastName}<br>Nom d&rsquo;utilisateur : ${sAMAccountName}<br><br>Si la suspension a &eacute;t&eacute; op&eacute;r&eacute;e par erreur, veuillez communiquer avec le Bureau des services technologiques d&rsquo;IGM. <br><br>Bureau des services technologiques d&rsquo;IGM <br>Lundi au vendredi de 7 h 30 &agrave; 19 h 30 (HE) <br>Num&eacute;ro de t&eacute;l&eacute;phone : 1-800-661-2040 <br>Portail SNAP &ndash; Clavardage en direct/Aide <br>https://igmfinancial.service-now.com/snap&nbsp;<br>Ce courriel a &eacute;t&eacute; produit par le syst&egrave;me. Veuillez ne pas y r&eacute;pondre. </p>",
                        "context": {
                            "firstName.$": "$.getIdentity.attributes.firstname",
                            "lastName.$": "$.getIdentity.attributes.lastname",
                            "sAMAccountName.$": "$.getIdentity.attributes.samaccountname"
                        },
                        "recipientEmailList": [
                            "fieldnetworkadministration@ig.ca"
                        ],
                        "subject": "Account Suspended for ${firstName} ${lastName} / Le compte de ${firstName} ${lastName} a été suspendu"
                    },
                    "description": "Email for Advisors. goes to Field Network Administration",
                    "nextStep": "success",
                    "type": "action",
                    "versionNumber": 2
                },
                "success": {
                    "description": null,
                    "type": "success"
                }
            }
        },
        "enabled": false,
        "creator": {
            "type": "IDENTITY",
            "id": "628f08e9d3754deb94463c6380d0f61d",
            "name": "slpt.services"
        },
        "owner": {
            "type": "IDENTITY",
            "id": "628f08e9d3754deb94463c6380d0f61d",
            "name": "slpt.services"
        },
        "trigger": {
            "type": "EVENT",
            "attributes": {
                "description": "Lifecycle State is suspended",
                "filter.$": "$.changes[?(@.attribute == \"cloudLifecycleState\")]",
                "id": "idn:identity-attributes-changed"
            }
        }
    }
}