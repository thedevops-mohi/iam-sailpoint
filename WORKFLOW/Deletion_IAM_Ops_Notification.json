{
    "version": 1,
    "var_self": {
        "type": "WORKFLOW",
        "id": "49d5f898-287a-4cf6-a1dd-d5900e72a6cc",
        "name": "Deletion IAM Ops Notification"
    },
    "object": {
        "id": "49d5f898-287a-4cf6-a1dd-d5900e72a6cc",
        "name": "Deletion IAM Ops Notification",
        "description": "Deletion IAM Ops Notification",
        "created": "2023-04-14T18:27:15.498781074Z",
        "modified": "2024-04-29T14:44:07.23966992Z",
        "modifiedBy": {
            "type": "IDENTITY",
            "id": "cf41145275194a66bd2989bcac443640",
            "name": "jyoti.gupta"
        },
        "definition": {
            "start": "Compare Strings",
            "steps": {
                "Compare Strings": {
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "Get Identity",
                            "variableA.$": "$.trigger.changes[?(@.attribute=='cloudLifecycleState')].newValue",
                            "variableB": "deleted"
                        }
                    ],
                    "defaultStep": "success",
                    "description": "Suspended?",
                    "type": "choice"
                },
                "Get Identity": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.trigger.identity.id"
                    },
                    "description": "Get Contractor Identity Information",
                    "nextStep": "Send Email",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "IAM Ops,<br>\n<br>\nA(n) ${userType} identity has changed to a deleted lifecycle state (21 days have passed since termination).<br>\nPlease reference the details below to deprovision appropriate access for this event.<br>\n<br>\nEvent Type: DELETION<br>\nShort Description: DELETION - ${userType} - ${sAMAccountName}<br>\nName: ${firstName} ${lastName}<br>\nUser Type: ${userType}<br>\nTermination Date: ${endDate}<br>\nLanguage: ${language}<br>\nManager: ${manager}<br>\nCompany: ${company}<br>\nDepartment: ${department}<br>\nTitle: ${title}<br>\nWork Location: ${street}, ${city}, ${postalCode}, ${country}<br>\n<br>\nThis is a system-generated email. Please do not respond to this email.",
                        "context": {
                            "city.$": "$.getIdentity.attributes.city",
                            "company.$": "$.getIdentity.attributes.company",
                            "country.$": "$.getIdentity.attributes.country",
                            "department.$": "$.getIdentity.attributes.department",
                            "endDate.$": "$.getIdentity.attributes.endDate",
                            "firstName.$": "$.getIdentity.attributes.firstname",
                            "language.$": "$.getIdentity.attributes.language",
                            "lastName.$": "$.getIdentity.attributes.lastname",
                            "manager.$": "$.getIdentity.managerRef.name",
                            "postalCode.$": "$.getIdentity.attributes.postalCode",
                            "sAMAccountName.$": "$.getIdentity.attributes.samaccountname",
                            "street.$": "$.getIdentity.attributes.street",
                            "title.$": "$.getIdentity.attributes.title",
                            "userType.$": "$.getIdentity.attributes.userType"
                        },
                        "from": null,
                        "recipientEmailList": [
                            "iamops@igmfinancial.com"
                        ],
                        "replyTo": null,
                        "subject": "Deleted ${userType} - ${firstName} ${lastName}"
                    },
                    "description": "Send email to IAM Ops",
                    "nextStep": "success",
                    "type": "action",
                    "versionNumber": 2
                },
                "success": {
                    "description": null,
                    "type": "success"
                }
            }
        },
        "enabled": false,
        "creator": {
            "type": "IDENTITY",
            "id": "2c918086837fb2ca0183c858c6597d08",
            "name": "emmanuel.martinez"
        },
        "owner": {
            "type": "IDENTITY",
            "id": "2c918086837fb2ca0183c858c6597d08",
            "name": "emmanuel.martinez"
        },
        "trigger": {
            "type": "EVENT",
            "attributes": {
                "description": "Lifecycle State is suspended",
                "filter.$": "$.changes[?(@.attribute == \"cloudLifecycleState\")]",
                "id": "idn:identity-attributes-changed"
            }
        }
    }
}