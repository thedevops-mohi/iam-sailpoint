{
    "version": 1,
    "var_self": {
        "type": "WORKFLOW",
        "id": "88fcfe3e-c2a0-4969-93d9-cc0e3ece9978",
        "name": "Notification Suspension or Leave of Absence"
    },
    "object": {
        "id": "88fcfe3e-c2a0-4969-93d9-cc0e3ece9978",
        "name": "Notification Suspension or Leave of Absence",
        "description": "Lifecycle state changed to suspended",
        "created": "2025-08-01T13:17:08.0735519Z",
        "modified": "2025-08-25T13:26:29.750816365Z",
        "modifiedBy": {
            "type": "IDENTITY",
            "id": "1883596e385748c7bec4833a76bacad4",
            "name": "Khilan.Shah"
        },
        "definition": {
            "start": "Compare Strings",
            "steps": {
                "Compare Strings": {
                    "actionId": "sp:compare-strings",
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "Get Identity",
                            "variableA.$": "$.trigger.changes[?(@.attribute=='cloudLifecycleState')].newValue",
                            "variableB": "suspended"
                        }
                    ],
                    "defaultStep": "success",
                    "description": "Suspended?",
                    "type": "choice"
                },
                "Compare Strings 1": {
                    "actionId": "sp:compare-strings",
                    "choiceList": [
                        {
                            "comparator": "StringEquals",
                            "nextStep": "Send Email 1",
                            "variableA.$": "$.getIdentity.attributes.userType",
                            "variableB": "Advisor"
                        }
                    ],
                    "defaultStep": "Get Identity 1",
                    "description": "Check if an advisor, they don't have a manager so we have to handle differently",
                    "type": "choice"
                },
                "Get Identity": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.trigger.identity.id"
                    },
                    "description": "Get Contractor Identity Information",
                    "nextStep": "Compare Strings 1",
                    "type": "action",
                    "versionNumber": 2
                },
                "Get Identity 1": {
                    "actionId": "sp:get-identity",
                    "attributes": {
                        "id.$": "$.getIdentity.managerRef.id"
                    },
                    "description": "Get Manager Identity Information for email",
                    "nextStep": "Send Email",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "<p class=\"MsoNormal\">Dear ${managerFirstName} ${managerLastName},<br><br>You are receiving this notification because you are the manager of the following user, whose account has been suspended, and all system access has been disabled :<br><br>Name: ${firstName} ${lastName}<br>Username: ${sAMAccountName}<br style=\"mso-special-character: line-break;\"><!-- [if !supportLineBreakNewLine]--><br style=\"mso-special-character: line-break;\"><!--[endif]--></p>\n<p class=\"MsoNormal\">The account suspension was initiated by a SNAP Request, or due to account inactivity.<br style=\"mso-special-character: line-break;\"><!-- [if !supportLineBreakNewLine]--><br style=\"mso-special-character: line-break;\"><!--[endif]--></p>\n<p class=\"MsoNormal\">For any questions or further assistance, please refer to [KB Link] or contact the IAM Operations team at&nbsp;<a href=\"mailto:iamops@igmfinancial.com\" target=\"_blank\" rel=\"noopener\">iamops@igmfinancial.com</a>.</p>\n<p class=\"MsoNormal\"><span lang=\"FR\" style=\"mso-ansi-language: FR;\">Best regards,<br>IAM Operations Team</span></p>\n<p class=\"MsoNormal\"><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">Bonjour&nbsp;${managerFirstName} ${managerLastName},<br><br>Vous recevez cet avis parce que le compte de votre subordonn&eacute; direct ci-dessous a &eacute;t&eacute; suspendu et que tous ses acc&egrave;s ont &eacute;t&eacute; d&eacute;sactiv&eacute;s&nbsp;:<br><br>Nom&nbsp;:&nbsp;${firstName} ${lastName}<br>Nom d&rsquo;utilisateur&nbsp;: ${sAMAccountName}<br style=\"mso-special-character: line-break;\"><!-- [if !supportLineBreakNewLine]--><br style=\"mso-special-character: line-break;\"><!--[endif]--></span></p>\n<p class=\"MsoNormal\"><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">Le compte a &eacute;t&eacute; suspendu &agrave; la suite d&rsquo;une demande&nbsp;SNAP ou parce que le compte &eacute;tait inactif.<br style=\"mso-special-character: line-break;\"><!-- [if !supportLineBreakNewLine]--><br style=\"mso-special-character: line-break;\"><!--[endif]--></span></p>\n<p class=\"MsoNormal\"><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">Si vous avez des questions ou si vous avez besoin d&rsquo;aide, veuillez consulter l&rsquo;article [KB Link] ou &eacute;crire un courriel &agrave; l&rsquo;&eacute;quipe de gestion des acc&egrave;s et des identit&eacute;s &agrave; </span><a href=\"mailto:iamops@igmfinancial.com\" target=\"_blank\" rel=\"noopener\"><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">iamops@igmfinancial.com</span></a><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">.</span></p>\n<p class=\"MsoNormal\"><span lang=\"FR-CA\" style=\"mso-ansi-language: FR-CA;\">Cordialement,<br>&Eacute;quipe de gestion des acc&egrave;s et des identit&eacute;s</span></p>",
                        "context": {
                            "firstName.$": "$.getIdentity.attributes.firstname",
                            "lastName.$": "$.getIdentity.attributes.lastname",
                            "managerFirstName.$": "$.getIdentity1.attributes.firstname",
                            "managerLastName.$": "$.getIdentity1.attributes.lastname",
                            "sAMAccountName.$": "$.getIdentity.attributes.samaccountname"
                        },
                        "from": null,
                        "recipientEmailList.$": "$.getIdentity1.attributes.email",
                        "replyTo": "",
                        "subject": "Account Suspended for ${firstName} ${lastName}/ Suspension du compte de ${firstName} ${lastName}"
                    },
                    "description": "Send email to manager",
                    "nextStep": "success",
                    "type": "action",
                    "versionNumber": 2
                },
                "Send Email 1": {
                    "actionId": "sp:send-email",
                    "attributes": {
                        "body": "<p>Dear Field Network Administration<br><br>The account has been suspended successfully and all system access has been disabled.<br><br>Name: ${firstName} ${lastName}<br>Username: ${sAMAccountName}<br><br>If this was processed in error, please contact the IGM Service Desk.<br><br>IGM Service Desk <br>Mon &ndash; Fri 7:30 am to 7:30 pm ET<br>Phone Number: 1-800-661-2040<br>SNAP Portal &ndash; Live Chat / Get Help<br>https://igmfinancial.service-now.com/snap<br>This is a system-generated email. Please do not respond to this email.<br><br><br><br>Bonjour Field Network Administration,<br><br>Le compte a &eacute;t&eacute; suspendu avec succ&egrave;s et tous les acc&egrave;s au syst&egrave;me ont &eacute;t&eacute; d&eacute;sactiv&eacute;s. <br><br>Nom : ${firstName} ${lastName}<br>Nom d&rsquo;utilisateur : ${sAMAccountName}<br><br>Si la suspension a &eacute;t&eacute; op&eacute;r&eacute;e par erreur, veuillez communiquer avec le Bureau des services technologiques d&rsquo;IGM. <br><br>Bureau des services technologiques d&rsquo;IGM <br>Lundi au vendredi de 7 h 30 &agrave; 19 h 30 (HE) <br>Num&eacute;ro de t&eacute;l&eacute;phone : 1-800-661-2040 <br>Portail SNAP &ndash; Clavardage en direct/Aide <br>https://igmfinancial.service-now.com/snap&nbsp;<br>Ce courriel a &eacute;t&eacute; produit par le syst&egrave;me. Veuillez ne pas y r&eacute;pondre. </p>",
                        "context": {
                            "firstName.$": "$.getIdentity.attributes.firstname",
                            "lastName.$": "$.getIdentity.attributes.lastname",
                            "sAMAccountName.$": "$.getIdentity.attributes.samaccountname"
                        },
                        "recipientEmailList": [
                            "fieldnetworkadministration@ig.ca"
                        ],
                        "subject": "Account Suspended for ${firstName} ${lastName} / Le compte de ${firstName} ${lastName} a été suspendu"
                    },
                    "description": "Email for Advisors. goes to Field Network Administration",
                    "nextStep": "success",
                    "type": "action",
                    "versionNumber": 2
                },
                "success": {
                    "actionId": "sp:operator-success",
                    "description": null,
                    "type": "success"
                }
            }
        },
        "enabled": true,
        "creator": {
            "type": "IDENTITY",
            "id": "1883596e385748c7bec4833a76bacad4",
            "name": "Khilan.Shah"
        },
        "owner": {
            "type": "IDENTITY",
            "id": "1883596e385748c7bec4833a76bacad4",
            "name": "Khilan.Shah"
        },
        "trigger": {
            "type": "EVENT",
            "attributes": {
                "description": "Lifecycle State is suspended",
                "filter.$": "$.changes[?(@.attribute == \"cloudLifecycleState\")]",
                "id": "idn:identity-attributes-changed"
            }
        }
    }
}