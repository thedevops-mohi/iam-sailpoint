{
    "version": 1,
    "var_self": {
        "type": "TRANSFORM",
        "id": "6b44c478-43a1-443a-bb8e-a2c048823bce",
        "name": "BestSource"
    },
    "object": {
        "id": "6b44c478-43a1-443a-bb8e-a2c048823bce",
        "name": "BestSource",
        "type": "static",
        "attributes": {
            "TransformDesrcription": {
                "type": "static",
                "attributes": {
                    "Comment_20250624": "We may want to prioritize a SF non-auth source above SAPECC regardless of termiantion date as it really should always be superceeded by the new source",
                    "Comment_20250724": "Add in conversion of placeholder SF 9999-12-30 date values to be equivalent to null. Added in final value code.",
                    "Comment_20250822": "Insert sort/first record criteria for SuccessFactors acct lookups.",
                    "value": "Important Tranform - used to determine the most applicable source for many other transforms to select values from."
                }
            },
            "exceptionText": {
                "type": "static",
                "attributes": {
                    "value": "transform:BestSource:unhandled_case"
                }
            },
            "SFAuth_exists": {
                "type": "conditional",
                "attributes": {
                    "expression": "$rec_acct_id eq noRec",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "rec_acct_id": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "SuccessFactors-Auth",
                                        "attributeName": "PersonID",
                                        "accountSortAttribute": "StartDate_EmpInfo",
                                        "accountSortDescending": true,
                                        "accountReturnFirstLink": true
                                    }
                                },
                                "noRec"
                            ]
                        }
                    }
                }
            },
            "SFAuth_TermDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "SuccessFactors-Auth",
                                "attributeName": "Termination Date",
                                "accountSortAttribute": "StartDate_EmpInfo",
                                "accountSortDescending": true,
                                "accountReturnFirstLink": true
                            }
                        },
                        "null"
                    ]
                }
            },
            "SFAuth_Status": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "SuccessFactors-Auth",
                                "attributeName": "EmployeeStatus",
                                "accountSortAttribute": "StartDate_EmpInfo",
                                "accountSortDescending": true,
                                "accountReturnFirstLink": true
                            }
                        },
                        "null"
                    ]
                }
            },
            "SFNonAuth_exists": {
                "type": "conditional",
                "attributes": {
                    "expression": "$rec_acct_id eq noRec",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "rec_acct_id": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "SuccessFactors - NonAuthoritative",
                                        "attributeName": "PersonID"
                                    }
                                },
                                "noRec"
                            ]
                        }
                    }
                }
            },
            "SFNonAuth_TermDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "SuccessFactors - NonAuthoritative",
                                "attributeName": "Termination Date",
                                "accountSortAttribute": "StartDate_EmpInfo",
                                "accountSortDescending": true,
                                "accountReturnFirstLink": true
                            }
                        },
                        "null"
                    ]
                }
            },
            "SFNonAuth_TermDateEffective": {
                "type": "dateCompare",
                "attributes": {
                    "firstDate": {
                        "type": "dateFormat",
                        "attributes": {
                            "input": {
                                "type": "firstValid",
                                "attributes": {
                                    "values": [
                                        {
                                            "type": "accountAttribute",
                                            "attributes": {
                                                "sourceName": "SuccessFactors - NonAuthoritative",
                                                "attributeName": "Termination Date",
                                                "accountSortAttribute": "StartDate_EmpInfo",
                                                "accountSortDescending": true,
                                                "accountReturnFirstLink": true
                                            }
                                        },
                                        "2999-12-31"
                                    ],
                                    "ignoreErrors": false
                                }
                            },
                            "inputFormat": "yyyy-MM-dd",
                            "outputFormat": "ISO8601"
                        }
                    },
                    "secondDate": {
                        "type": "dateMath",
                        "attributes": {
                            "expression": "now",
                            "roundUp": true,
                            "input": {}
                        }
                    },
                    "operator": "lte",
                    "positiveCondition": "true",
                    "negativeCondition": "false"
                }
            },
            "SAPECC_exists": {
                "type": "conditional",
                "attributes": {
                    "expression": "$rec_acct_id eq noRec",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "rec_acct_id": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Employees SAP ECC",
                                        "attributeName": "PERNR"
                                    }
                                },
                                "noRec"
                            ]
                        }
                    }
                }
            },
            "SAPECC_TermDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "Employees SAP ECC",
                                "attributeName": "TERM_DATE"
                            }
                        },
                        "null"
                    ]
                }
            },
            "SAPECC_TermDateTime": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Employees SAP ECC",
                                        "attributeName": "TERM_DATE"
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "null"
                    ]
                }
            },
            "SIS_exists": {
                "type": "conditional",
                "attributes": {
                    "expression": "$rec_acct_id eq noRec",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "rec_acct_id": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Advisors - SIS Feed",
                                        "attributeName": "SIS-ID"
                                    }
                                },
                                "noRec"
                            ]
                        }
                    }
                }
            },
            "SIS_TermDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Advisors - SIS Feed",
                                        "attributeName": "TERM-DTE"
                                    }
                                },
                                "inputFormat": "yyyyMMdd",
                                "outputFormat": "yyyy-MM-dd"
                            }
                        },
                        "null"
                    ]
                }
            },
            "snowapi_exists": {
                "type": "conditional",
                "attributes": {
                    "expression": "$rec_acct_id eq noRec",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "rec_acct_id": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "ServiceNowAPI",
                                        "attributeName": "id"
                                    }
                                },
                                "noRec"
                            ]
                        }
                    }
                }
            },
            "snowapi_effectiveusertype": {
                "type": "static",
                "attributes": {
                    "loc_snowapi_userType": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "ServiceNowAPI",
                                        "attributeName": "userType"
                                    }
                                },
                                "null"
                            ]
                        }
                    },
                    "loc_snowapi_afterConvUserType": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "ServiceNowAPI",
                                        "attributeName": "afterConversionUserType"
                                    }
                                },
                                "null"
                            ]
                        }
                    },
                    "loc_snowapi_ConvDateReached": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "dateCompare",
                                    "attributes": {
                                        "firstDate": {
                                            "type": "dateFormat",
                                            "attributes": {
                                                "input": {
                                                    "type": "accountAttribute",
                                                    "attributes": {
                                                        "sourceName": "ServiceNowAPI",
                                                        "attributeName": "conversionDate"
                                                    }
                                                },
                                                "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                                "outputFormat": "ISO8601"
                                            }
                                        },
                                        "secondDate": "now",
                                        "operator": "lte",
                                        "positiveCondition": "true",
                                        "negativeCondition": "false"
                                    }
                                },
                                "false"
                            ]
                        }
                    },
                    "value": "#if($loc_snowapi_ConvDateReached == 'true')$loc_snowapi_afterConvUserType#elseif($loc_snowapi_ConvDateReached == 'false')$loc_snowapi_userType#{else}null#end"
                }
            },
            "snowapi_userType": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "userType"
                            }
                        },
                        "null"
                    ]
                }
            },
            "snowapi_afterConvUserType": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "afterConversionUserType"
                            }
                        },
                        "null"
                    ]
                }
            },
            "snowapi_ConvDateReached": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateCompare",
                            "attributes": {
                                "firstDate": {
                                    "type": "dateFormat",
                                    "attributes": {
                                        "input": {
                                            "type": "accountAttribute",
                                            "attributes": {
                                                "sourceName": "ServiceNowAPI",
                                                "attributeName": "conversionDate"
                                            }
                                        },
                                        "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                        "outputFormat": "ISO8601"
                                    }
                                },
                                "secondDate": "now",
                                "operator": "lte",
                                "positiveCondition": "true",
                                "negativeCondition": "false"
                            }
                        },
                        "false"
                    ]
                }
            },
            "snowapi_TermDateReached": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateCompare",
                            "attributes": {
                                "firstDate": {
                                    "type": "dateFormat",
                                    "attributes": {
                                        "input": {
                                            "type": "accountAttribute",
                                            "attributes": {
                                                "sourceName": "ServiceNowAPI",
                                                "attributeName": "endDate"
                                            }
                                        },
                                        "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                        "outputFormat": "ISO8601"
                                    }
                                },
                                "secondDate": "now",
                                "operator": "lte",
                                "positiveCondition": "true",
                                "negativeCondition": "false"
                            }
                        },
                        "false"
                    ]
                }
            },
            "snowapi_TermDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "ServiceNowAPI",
                                        "attributeName": "endDate"
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                "outputFormat": "yyyy-MM-dd"
                            }
                        },
                        "null"
                    ]
                }
            },
            "snowapi_TermDateTime": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "endDate"
                            }
                        },
                        "null"
                    ]
                }
            },
            "value": "#if ($SFAuth_TermDate == '9999-12-30')#set($SFAuth_TermDate = 'null')#end#if ($SFNonAuth_TermDate == '9999-12-30')#set($SFNonAuth_TermDate = 'null')#end#set($datelist = [$snowapi_TermDate, $SIS_TermDate, $SAPECC_TermDate, $SFNonAuth_TermDate, $SFAuth_TermDate])#set($existchecklist = [$snowapi_exists, $SIS_exists, $SAPECC_exists, $SFNonAuth_exists, $SFAuth_exists])#set($bestSourcelist = ['use_ServiceNow', 'use_SIS', 'use_SAPECC', 'use_SFNonAuth', 'use_SFAuth'])#set($listsizeminusone = $datelist.size() - 1)#set($varBestSource = 'placeholder')#set($maxDate = '1900-01-01')#set($varSnowValidUsertype = 'placeholder')#set($loopcounter = 0)#set($maxIndex = 0)#if ($snowapi_effectiveusertype.equalsIgnoreCase('contractor') && $snowapi_TermDateReached == 'false')#set($varSnowValidUsertype = 'ActiveContractor')#set($varBestSource = 'use_ServiceNow')#elseif($SFAuth_exists == 'true' && $SFAuth_TermDate == 'null')#set($varBestSource = 'use_SFAuth')#elseif($SFNonAuth_exists == 'true' && $SFNonAuth_TermDate == 'null')#set($varBestSource = 'use_SFNonAuth')#elseif($SAPECC_exists == 'true' && $SAPECC_TermDate == 'null')#set($varBestSource = 'use_SAPECC')#elseif($SIS_exists == 'true' && ($SIS_TermDate == '0' || $SIS_TermDate == 'null'))#set($varBestSource = 'use_SIS')#{else}#foreach($i in [0..$listsizeminusone])#set($loopcounter = $i)#if($existchecklist[$i] == 'true' && ($datelist[$i] != 'null' && $maxDate != 'null' && $datelist[$i].compareTo($maxDate) >= 0))#set($maxDate = $datelist[$i])#set($maxIndex = $i)#set($varBestSource = $bestSourcelist[$i])#end#end#end#if($varBestSource == 'placeholder' && $snowapi_exists == 'true')#set($varBestSource = 'use_ServiceNow')#end$varBestSource"
        },
        "internal": false
    }
}