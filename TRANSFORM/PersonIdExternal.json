{
    "version": 1,
    "var_self": {
        "type": "TRANSFORM",
        "id": "59907586-5060-4705-be58-caa9f7668760",
        "name": "PersonIdExternal"
    },
    "object": {
        "id": "59907586-5060-4705-be58-caa9f7668760",
        "name": "PersonIdExternal",
        "type": "static",
        "attributes": {
            "TransformDesrcription": {
                "type": "static",
                "attributes": {
                    "change_TWF": "Add new HR sources and migration xref source to provide PersonIDExternal/EmployeeID ",
                    "Comment_20250502": "NOTE !!!!! Temporarily we are removing the oldValue fall-through to avoid duplicate personids between mock loads",
                    "Comment_20250815": "REVISING structure significantly to use all sources, and allow for retention of current/oldValue if there is no other valid value.",
                    "Comment_20250819": "Need to add back in the migration xref source as a potential valid source if no others are available, regardless of bestsource/sourceoftruth. Initially this may be needed for any user type other than contractor - and even then it might be applicable if they were previously an employee.",
                    "value": "Populate the <personIdExternal> attribute. For most cases the <personIdExternal> (PIE) attribute will matche the EmployeeNumber, however when there are major job changes in SF then a new EmployeeNumber must/will be assigned, but the PersonIdExternal tends to remain unchanged as the value for the first (no longer active) Job identifier. So PIE is more-or-less an alternate unique person identifier for persons in SuccessFactors, BUT seems less clear/reliable than PersonID for true unique correlation for new SF records on the same person going forward."
                }
            },
            "exceptionText": {
                "type": "static",
                "attributes": {
                    "value": "transform:PersonIdExternal:unhandled_case"
                }
            },
            "bestSource": {
                "type": "reference",
                "attributes": {
                    "id": "BestSource"
                }
            },
            "SFAuth_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "SuccessFactors-Auth",
                                "attributeName": "Person ID External"
                            }
                        },
                        "null"
                    ]
                }
            },
            "SFNonAuth_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "SuccessFactors - NonAuthoritative",
                                "attributeName": "Person ID External"
                            }
                        },
                        "null"
                    ]
                }
            },
            "SAP_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "Employees SAP ECC",
                                "attributeName": "PERNR"
                            }
                        },
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "employeeNumber"
                            }
                        },
                        "null"
                    ]
                }
            },
            "SIS_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        "null"
                    ]
                }
            },
            "SNOW_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "employeeNumber"
                            }
                        },
                        "null"
                    ]
                }
            },
            "twf_migration_xref_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "unconn_PersonID_xref",
                                "attributeName": "personIDExternal"
                            }
                        },
                        "null"
                    ]
                }
            },
            "safe_oldvalue_future": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        "$oldValue",
                        "null"
                    ]
                }
            },
            "safe_oldvalue": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        "null"
                    ]
                }
            },
            "value_variations": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        "null",
                        "#if($bestSource == 'use_SFAuth' && $SFAuth_value != 'null')#set($finalValue = $SFAuth_value)#elseif($bestSource == 'use_SFNonAuth' && $SFNonAuth_value != 'null')#set($finalValue = $SFNonAuth_value)#elseif($bestSource == 'use_SAPECC' && $SAP_value != 'null')#set($finalValue = $SAP_value)#elseif($bestSource == 'use_SIS' && $SIS_value != 'null')#set($finalValue = $SIS_value)#elseif($bestSource == 'use_ServiceNow' && $SNOW_value != 'null')#set($finalValue = $SNOW_value)#elseif($safe_oldvalue != 'null')#set($finalValue = $safe_oldvalue)#{else}#set($finalValue = $exceptionText)#end#if($finalValue != 'null')$finalValue#end",
                        "#if($bestSource == 'use_SFAuth' && $SFAuth_value != 'null')#set($finalValue = $SFAuth_value)#elseif($bestSource == 'use_SFNonAuth' && $SFNonAuth_value != 'null')#set($finalValue = $SFNonAuth_value)#elseif($bestSource == 'use_SAPECC' && $SAP_value != 'null')#set($finalValue = $SAP_value)#elseif($bestSource == 'use_SIS' && $SIS_value != 'null')#set($finalValue = $SIS_value)#elseif($bestSource == 'use_ServiceNow' && $SNOW_value != 'null')#set($finalValue = $SNOW_value)#elseif($twf_migration_xref_value != 'null')#set($finalValue = $twf_migration_xref_value)#elseif($safe_oldvalue != 'null')#set($finalValue = $safe_oldvalue)#{else}#set($finalValue = $safe_oldvalue)#end#if($finalValue != 'null')$finalValue#end",
                        "#if($bestSource == 'use_SFAuth' && $SFAuth_value != 'null')#set($finalValue = $SFAuth_value)#elseif($bestSource == 'use_SFNonAuth' && $SFNonAuth_value != 'null')#set($finalValue = $SFNonAuth_value)#elseif($bestSource == 'use_SAPECC' && $SAP_value != 'null')#set($finalValue = $SAP_value)#elseif($bestSource == 'use_SIS' && $SIS_value != 'null')#set($finalValue = $SIS_value)#elseif($bestSource == 'use_ServiceNow' && $SNOW_value != 'null')#set($finalValue = $SNOW_value)#elseif($twf_migration_xref_value != 'null')#set($finalValue = $twf_migration_xref_value)#elseif($safe_oldvalue != 'null')#set($finalValue = $safe_oldvalue)#{else}#set($finalValue = $safe_oldvalue)#end#if($finalValue != 'null')$finalValue#end"
                    ]
                }
            },
            "value": "#if($bestSource == 'use_SFAuth' && $SFAuth_value != 'null')#set($finalValue = $SFAuth_value)#elseif($bestSource == 'use_SFNonAuth' && $SFNonAuth_value != 'null')#set($finalValue = $SFNonAuth_value)#elseif($bestSource == 'use_SAPECC' && $SAP_value != 'null')#set($finalValue = $SAP_value)#elseif($twf_migration_xref_value != 'null')#set($finalValue = $twf_migration_xref_value)#elseif($safe_oldvalue != 'null')#set($finalValue = $safe_oldvalue)#{else}#set($finalValue = $safe_oldvalue)#end#if($finalValue != 'null')$finalValue#end"
        },
        "internal": false
    }
}