{
    "version": 1,
    "var_self": {
        "type": "TRANSFORM",
        "id": "e4fa2192-43b1-486e-a404-a67777f58915",
        "name": "EndDateWithTime"
    },
    "object": {
        "id": "e4fa2192-43b1-486e-a404-a67777f58915",
        "name": "EndDateWithTime",
        "type": "static",
        "attributes": {
            "requiresPeriodicRefresh": true,
            "userType": {
                "type": "reference",
                "attributes": {
                    "id": "UserType"
                }
            },
            "hasSapEccAccount": {
                "type": "conditional",
                "attributes": {
                    "expression": "$hasSapEccAccount eq null",
                    "positiveCondition": "false",
                    "negativeCondition": "true",
                    "hasSapEccAccount": {
                        "type": "firstValid",
                        "attributes": {
                            "values": [
                                {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Employees SAP ECC",
                                        "attributeName": "PERNR"
                                    }
                                },
                                "null"
                            ]
                        }
                    }
                }
            },
            "employeeSapEccEndDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Employees SAP ECC",
                                        "attributeName": "TERM_DATE"
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "serviceNowApiEndDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "endDate"
                            }
                        },
                        "None"
                    ]
                }
            },
            "snowAPIConvDateReached": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateCompare",
                            "attributes": {
                                "firstDate": {
                                    "type": "dateFormat",
                                    "attributes": {
                                        "input": {
                                            "type": "accountAttribute",
                                            "attributes": {
                                                "sourceName": "ServiceNowAPI",
                                                "attributeName": "conversionDate"
                                            }
                                        },
                                        "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                        "outputFormat": "ISO8601"
                                    }
                                },
                                "secondDate": "now",
                                "operator": "lte",
                                "positiveCondition": "true",
                                "negativeCondition": "false"
                            }
                        },
                        "null"
                    ]
                }
            },
            "advisorEndDate": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Advisors - SIS Feed",
                                        "attributeName": "TERM-DTE"
                                    }
                                },
                                "inputFormat": "yyyyMMdd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "value": "#if($userType == 'Advisor')$advisorEndDate#elseif($userType == 'Employee' && $hasSapEccAccount == 'true')$employeeSapEccEndDate#elseif($userType == 'Employee' && $hasSapEccAccount == 'false' && $snowAPIConvDateReached == 'true')None#elseif($userType == 'Employee' && $hasSapEccAccount == 'false' && $snowAPIConvDateReached != 'true')$serviceNowApiEndDate#elseif($userType == 'Contractor')$serviceNowApiEndDate#{else}error: unhandled userType/case: $userType#end"
        },
        "internal": false
    }
}