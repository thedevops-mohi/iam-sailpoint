{
    "version": 1,
    "var_self": {
        "type": "TRANSFORM",
        "id": "e4fa2192-43b1-486e-a404-a67777f58915",
        "name": "EndDateWithTime"
    },
    "object": {
        "id": "e4fa2192-43b1-486e-a404-a67777f58915",
        "name": "EndDateWithTime",
        "type": "static",
        "attributes": {
            "requiresPeriodicRefresh": true,
            "userType": {
                "type": "reference",
                "attributes": {
                    "id": "UserType"
                }
            },
            "snowAPIConvDateReached": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateCompare",
                            "attributes": {
                                "firstDate": {
                                    "type": "dateFormat",
                                    "attributes": {
                                        "input": {
                                            "type": "accountAttribute",
                                            "attributes": {
                                                "sourceName": "ServiceNowAPI",
                                                "attributeName": "conversionDate"
                                            }
                                        },
                                        "inputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm",
                                        "outputFormat": "ISO8601"
                                    }
                                },
                                "secondDate": "now",
                                "operator": "lte",
                                "positiveCondition": "true",
                                "negativeCondition": "false"
                            }
                        },
                        "null"
                    ]
                }
            },
            "value": "#if($bestSource == 'use_SFAuth')#set($finalValue = $SFAuth_value)#elseif($bestSource == 'use_SFNonAuth')#set($finalValue = $SFNonAuth_value)#elseif($bestSource == 'use_SAPECC')#set($finalValue = $SAP_value)#elseif($bestSource == 'use_SIS')#set($finalValue = $SIS_value)#elseif($bestSource.compareToIgnoreCase('use_servicenow') == 0)#set($finalValue = $SNOW_value)#{else}#set($finalValue = $exceptionText)#end#if($finalValue != 'null')$finalValue#end",
            "SAP_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Employees SAP ECC",
                                        "attributeName": "TERM_DATE"
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "SFAuth_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "SuccessFactors-Auth",
                                        "attributeName": "Termination Date",
                                        "accountSortAttribute": "StartDate_EmpInfo",
                                        "accountSortDescending": true,
                                        "accountReturnFirstLink": true
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "SFNonAuth_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "SuccessFactors - NonAuthoritative",
                                        "attributeName": "Termination Date",
                                        "accountSortAttribute": "StartDate_EmpInfo",
                                        "accountSortDescending": true,
                                        "accountReturnFirstLink": true
                                    }
                                },
                                "inputFormat": "yyyy-MM-dd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "SIS_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "dateFormat",
                            "attributes": {
                                "input": {
                                    "type": "accountAttribute",
                                    "attributes": {
                                        "sourceName": "Advisors - SIS Feed",
                                        "attributeName": "TERM-DTE"
                                    }
                                },
                                "inputFormat": "yyyyMMdd",
                                "outputFormat": "yyyy-MM-dd'T'-HH:mm:ss:SSS-HH:mm"
                            }
                        },
                        "None"
                    ]
                }
            },
            "SNOW_value": {
                "type": "firstValid",
                "attributes": {
                    "values": [
                        {
                            "type": "accountAttribute",
                            "attributes": {
                                "sourceName": "ServiceNowAPI",
                                "attributeName": "endDate"
                            }
                        },
                        "None"
                    ]
                }
            },
            "TransformDesrcription": {
                "type": "static",
                "attributes": {
                    "Description": "This transform is for population of the End Date including the time of day.",
                    "update 2025-05-??": "Jyoti Gupta - initial changes for TWF - refactor with bestSource approach",
                    "update_2025-06-22": "Scott Walker - Add improved comments and review TWF updates.",
                    "update_2025-06-24": "Scott Walker - Correct/simplify the handling for bestSource = use_servicenow and usertype = Employee. We shouldn't need to use special overrides. Assuming the userType transform is correctly determining (incorporating conversions) that the current userType is in fact employee, and that the bestSource is ServiceNowAPI then we can just use the EndDate regardless. It's possible that an employee was never fully onboarded and should have an enddate from servicenowapi. ",
                    "value": "This transform is for population of the End Date including the time of day."
                }
            },
            "bestSource": {
                "type": "reference",
                "attributes": {
                    "id": "BestSource"
                }
            },
            "exceptionText": {
                "type": "static",
                "attributes": {
                    "value": "transform:EndDateWithTime:Unhandled Case"
                }
            }
        },
        "internal": false
    }
}